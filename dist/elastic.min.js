/*! Elastic.js - v0.0.0 ( 2013-05-07 ) - MIT */
(function(t){"use strict";function e(t,e){for(var n,o=0,i=Object.keys(e),r=i.length;r>o;o++)n=i[o],t[n]=e[n];return t}function n(t,n){var o,i,r;return o=t,n.hasOwnProperty("constructor")?(i=n.constructor,delete n.constructor,r=n):"[object Function]"===Object.prototype.toString.call(n)?(i=n,r=n.prototype):(i=u(o),r=n),e(i,o),i.prototype=Object.create(o.prototype),i.prototype.constructor=i,e(i.prototype,r),i.__super__=o.prototype,i.__super__.constructor=o,i.prototype.super=c(i),i}function o(t,n){var o;1===arguments.length?n=t:o=t;var u="function"==typeof o?o:n.hasOwnProperty("constructor")?n.constructor:function(){};return delete n.constructor,e(u.prototype,n),u.extends=i,Object.defineProperty(u,"extends",f),u.with=r,Object.defineProperty(u,"with",f),u.create=s,Object.defineProperty(u,"create",f),u}function i(t,e){return 1===arguments.length?e=t:e.constructor=t,n(this,e)}function r(t,n){var o,i=0,r=Object.keys(t),s=r.length,u={};for(n||(n={});s>i;i++)o=r[i],n[o]?u[n[o]]=t[o]:u[o]=t[o];return e(this.prototype,u),this}function s(){var t=Object.create(this.prototype);return this.apply(t,arguments),t}function u(t){return function(){return t.apply(this,arguments)}}function c(t){return function(e,n){return t.__super__[e].apply(this,n)}}function a(t,e){if(null!=t)for(var n,o="[object Array]"==Object.prototype.toString.call(t),i=o?t:Object.keys(t),r=0,s=i.length;s>r;r++)n=i[r],e(n,r)}function h(t,e){var n,o;if(n=e.charAt(0).toUpperCase()+e.slice(1),e in t?o=e:"webkit"+n in t?o="webkit"+n:"moz"+n in t?o="moz"+n:"ms"+n in t?o="ms"+n:"o"+n in t&&(o="o"+n),o)return o;throw new y(e+" not found in specified object")}function l(t){return!(!t||1!==t.nodeType)}var f={writable:!1},p="__UNDEFINED__",d={of:o,mix:e,inherits:n},m=d.of({type:p,constructor:function(t){if(this.type===p)throw new g("You must specify a unique type for the Exception");this.error=Error(t),this.error.name=this.type+"Exception"},getMessage:function(){return this.error.message},getTraceAsString:function(){return this.error.stack},toString:function(){return""+this.error}}),g=m.extends({type:"Logic"}),y=m.extends({type:"Runtime"}),_=d.of({el:null,$el:null,_selector:function(t){var e;return e="#"===t.charAt(0)?document.getElementById(t.slice(1)):document.querySelector(t)},_element:function(e){this.el=e,t.$&&(this.$el=$(this.el))},onCreate:function(){},onDestroy:function(){}}),v=_.extends({events:{},ui:{},uid:null,constructor:function(t,e){this._element(t),this.uid=e,this.setupUi(),this.onCreate()},destroy:function(){this.el=this.$el=null,this.teardownUi(),this.onDestroy()},setupUi:function(){var e,n,o={};for(e in this.ui)n=this.ui[e],o[e]="$"in t?this.$el.find(n):this.el.querySelectorAll(n);this.ui=o},teardownUi:function(){var t;for(t in this.ui)this.ui[key]=null,delete this.ui[key]}}),w=_.extends({name:p,regions:{},_assignedMap:{},constructor:function(t){if(this.name===p)throw new g("You must specify a unique name for the Layout");t||(t={}),t.regions&&(this.regions=e(t.regions,this.regions)),"string"==typeof this.el&&this._element(this._selector(this.el)),this.onCreate()},assign:function(t,e){var n,o,i;if(n=this.regions[t],i=this.getRegionView(t),!n)throw new g("Could not get a selector from the region "+t);o=this._selector(n),this.onChange(t,e,i),i instanceof x&&i.destroy(),e.attachElement(o),this._assignedMap[t]=e},getRegionView:function(t){if(!t in this.regions)throw new g("Undefined region `"+t+"` is specified");return this._assignedMap[t]||null},withdraw:function(t){var e;return e=this.getRegionView(t),e instanceof x&&(e.detachElement(),this._assignedMap[t]=null),e},destroy:function(){this.onDestroy();for(var t,e=0,n=Object.keys(this.regions),o=this.regions.length;o>e;e++)t=n[e],this.withdraw(t).destroy()},onChange:function(){}}),b="data-component",k="data-component-uid",E={},j=0,x=_.extends({name:p,events:{},ui:{},components:{},_delegater:null,constructor:function(){if("string"==typeof this.el&&this._element(this._selector(this.el)),this.name===p)throw new g("You must specify a unique name for the View");this._delegater=new D(this.el),l(this.el)&&this.attachElement(this.el),this.onCreate()},attachElement:function(t){if(!l(t))throw new y("Gived argument `el` is not an element");this._element(t),this._delegater.setRoot(t),this.onAttach(t),this.setupUi(),this.delegateEvents()},detachElement:function(){this.undelegateEvents(),this.teardownUi(),this.onDetach(this.el),this.el=this.$el=null},delegateEvents:function(){var t,e,n,o,i,r,s=this;a(this.events,function(o){n=s[s.events[o]],o=o.split(" "),t=o[0],e=o[1],s._delegater.add(t,e,n,s)}),a(this.components,function(n){o=s.components[n].prototype,a(o.events,function(n){i=o.events[n],n=n.split(" "),t=n[0],e=n[1],r=function(t){var e=this.getComponent(t.target);e[i].apply(e,arguments)},s._delegater.add(t,e,r,s)})})},undelegateEvents:function(){this._delegater.remove()},use:function(t,e){this.components[t]=e},getComponent:function(t){var e,n;do e=t.getAttribute(b);while(!e&&(t=t.parentNode));if(!e)throw new y("Component name is not detected from "+b);return n=t.getAttribute(k)||j++,E[n]?E[n]:(t.setAttribute(k,n),E[n]=new this.components[e](t,n))},setupUi:function(){var e,n;for(e in this.ui)n=this.ui[e],this.ui[e]="$"in t?this.$el.find(n):this.el.querySelectorAll(n)},teardownUi:function(){var t;for(t in this.ui)this.ui[key]=null,delete this.ui[key]},destroy:function(){this.detachElement(),this.onDestroy()},render:function(t){return this.el.innerHTML=t,this},onAttach:function(){},onDetach:function(){}}),A={},C={},O=0,D=d.of({_root:null,_matcher:null,_stack:{},constructor:function(t){t&&this.setRoot(t)},setRoot:function(t){l(this._root)&&this.remove(),this._root=t,this._matcher=h(t,"matchesSelector")},add:function(t,e,n,o){var i;i=this._createDelegateHandler(t,e,n,o),this._root.addEventListener(t,i,!0)},_createDelegateHandler:function(t,e,n,o){var i,r,s=this;return r=function(t){var i=t.target;do{if(i!==t.target&&i===s._root||!(s._matcher in i))return!1;if(i[s._matcher](e))break}while(i=i.parentNode);return n.call(o||i,t)},r._type=t,r._selector=e,i=n._uid||(n._uid=++O),this._stack[i]||(this._stack[i]=[]),this._stack[i].push(r),r},remove:function(t,e,n){var o=this;a(this._stack,function(i){n&&n._uid&&n._uid!=i||a(o._stack[i],function(n,r){o._isRemoveApprovable(t,e,n)&&(o._stack[i].splice(r,1),o._root.removeEventListener(n._type,n,!0))})})},_isRemoveApprovable:function(t,e,n){return!(t&&t!==n._type||e&&e!==n._selector)}}),R=d.of({constructor:function(){}}),U=d.of({constructor:function(){}}),S=d.of({constructor:function(){}}),L=d.of({constructor:function(){}}),V={klass:d,Layout:w,View:x,Component:v,domain:{Layout:w,View:x,Compontnt:v},exception:{Runtime:y,Logic:g},util:{History:R,Router:U,Storage:S,Validator:L,DomDelegation:D},trait:{AsyncCallback:A,Observable:C}};"function"==typeof define&&"object"==typeof define.amd&&define.amd?t.define(function(){return V}):"object"==typeof module&&module&&"object"==typeof exports&&exports&&module.exports==exports?module.exports=V:t.Elastic=V})(this);